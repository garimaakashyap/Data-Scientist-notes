# Python Intermediate

## Table of Contents
1. [Functions](#functions)
2. [Lambda Functions](#lambda-functions)
3. [Modules and Packages](#modules-and-packages)
4. [Object-Oriented Programming](#object-oriented-programming)
5. [File Handling](#file-handling)
6. [Exception Handling](#exception-handling)
7. [Regular Expressions](#regular-expressions)
8. [Working with Dates and Time](#working-with-dates-and-time)
9. [JSON and Data Serialization](#json-and-data-serialization)
10. [Iterators and Generators](#iterators-and-generators)

---

## Functions

### Function Definition
```python
# Basic function
def greet():
    print("Hello, World!")

# Function with parameters
def greet(name):
    print(f"Hello, {name}!")

# Function with default parameters
def greet(name, greeting="Hello"):
    print(f"{greeting}, {name}!")

# Function with multiple parameters
def add(a, b):
    return a + b

# Function with multiple return values
def get_name_age():
    return "Alice", 30

name, age = get_name_age()
```

### Function Arguments
```python
# Positional arguments
def power(base, exponent):
    return base ** exponent

result = power(2, 3)  # 8

# Keyword arguments
result = power(exponent=3, base=2)  # 8

# Default arguments
def power(base, exponent=2):
    return base ** exponent

result = power(3)     # 9 (exponent defaults to 2)
result = power(3, 4)  # 81

# Variable-length arguments (*args)
def sum_all(*args):
    return sum(args)

result = sum_all(1, 2, 3, 4, 5)  # 15

# Variable-length keyword arguments (**kwargs)
def print_info(**kwargs):
    for key, value in kwargs.items():
        print(f"{key}: {value}")

print_info(name="Alice", age=30, city="NYC")

# Combining all types
def complex_func(required, default="value", *args, **kwargs):
    pass
```

### Docstrings
```python
def add(a, b):
    """
    Add two numbers together.
    
    Args:
        a (int): First number
        b (int): Second number
    
    Returns:
        int: Sum of a and b
    """
    return a + b

# Access docstring
print(add.__doc__)
help(add)
```

### Variable Scope
```python
# Global variable
x = 10

def func():
    # Local variable
    y = 20
    print(x)  # Can access global
    print(y)  # Local variable

# Modifying global variable
x = 10

def func():
    global x
    x = 20  # Modify global variable

func()
print(x)  # 20

# Nonlocal (for nested functions)
def outer():
    x = 10
    def inner():
        nonlocal x
        x = 20  # Modify outer function's variable
    inner()
    print(x)  # 20
```

### Function Annotations
```python
def add(a: int, b: int) -> int:
    """Add two integers and return the result."""
    return a + b

# Type hints (Python 3.5+)
from typing import List, Dict, Optional

def process_data(data: List[int]) -> Dict[str, int]:
    return {"sum": sum(data), "count": len(data)}

def get_value(key: str) -> Optional[str]:
    # Returns str or None
    pass
```

---

## Lambda Functions

### Basic Syntax
```python
# Regular function
def add(a, b):
    return a + b

# Lambda function (anonymous function)
add = lambda a, b: a + b

# Usage
result = add(3, 5)  # 8

# Common use cases
numbers = [1, 2, 3, 4, 5]
squared = list(map(lambda x: x**2, numbers))  # [1, 4, 9, 16, 25]
evens = list(filter(lambda x: x % 2 == 0, numbers))  # [2, 4]
sorted_by_abs = sorted([-3, 1, -2, 4], key=lambda x: abs(x))  # [1, -2, -3, 4]
```

### Lambda with map, filter, reduce
```python
from functools import reduce

# Map - apply function to each element
numbers = [1, 2, 3, 4, 5]
squared = list(map(lambda x: x**2, numbers))

# Filter - filter elements based on condition
evens = list(filter(lambda x: x % 2 == 0, numbers))

# Reduce - reduce sequence to single value
sum_all = reduce(lambda x, y: x + y, numbers)  # 15
product = reduce(lambda x, y: x * y, numbers)  # 120
```

---

## Modules and Packages

### Creating Modules
```python
# math_utils.py
def add(a, b):
    return a + b

def multiply(a, b):
    return a * b

PI = 3.14159
```

### Importing Modules
```python
# Import entire module
import math
result = math.sqrt(16)  # 4.0

# Import specific function
from math import sqrt
result = sqrt(16)  # 4.0

# Import with alias
import math as m
result = m.sqrt(16)  # 4.0

# Import multiple functions
from math import sqrt, sin, cos

# Import all (not recommended)
from math import *
result = sqrt(16)  # Can use without math prefix

# Import custom module
import math_utils
result = math_utils.add(3, 5)

from math_utils import add, multiply
result = add(3, 5)
```

### Packages
```python
# Package structure:
# mypackage/
#     __init__.py
#     module1.py
#     module2.py
#     subpackage/
#         __init__.py
#         module3.py

# Import from package
from mypackage import module1
from mypackage.module1 import function1
from mypackage.subpackage import module3
```

### Standard Library Modules
```python
# os - Operating system interface
import os
os.getcwd()  # Current working directory
os.listdir('.')  # List files in directory
os.path.join('folder', 'file.txt')  # Path joining

# sys - System-specific parameters
import sys
sys.argv  # Command line arguments
sys.path  # Python path
sys.exit(0)  # Exit program

# collections - Specialized container datatypes
from collections import Counter, defaultdict, deque
counter = Counter([1, 2, 2, 3, 3, 3])  # Counter({3: 3, 2: 2, 1: 1})
dd = defaultdict(int)  # Default value is 0
dq = deque([1, 2, 3])  # Double-ended queue

# itertools - Iterator functions
from itertools import permutations, combinations, cycle
perms = list(permutations([1, 2, 3]))  # All permutations
combs = list(combinations([1, 2, 3], 2))  # All combinations of 2

# random - Random number generation
import random
random.randint(1, 10)  # Random integer between 1 and 10
random.choice([1, 2, 3, 4, 5])  # Random choice from list
random.shuffle([1, 2, 3, 4, 5])  # Shuffle list in-place

# datetime - Date and time operations
from datetime import datetime, timedelta
now = datetime.now()
tomorrow = now + timedelta(days=1)

# json - JSON encoder and decoder
import json
data = {"name": "Alice", "age": 30}
json_str = json.dumps(data)  # Convert to JSON string
data = json.loads(json_str)  # Convert from JSON string
```

---

## Object-Oriented Programming

### Classes and Objects
```python
# Basic class
class Dog:
    # Class attribute (shared by all instances)
    species = "Canis familiaris"
    
    # Constructor (__init__)
    def __init__(self, name, age):
        # Instance attributes
        self.name = name
        self.age = age
    
    # Instance method
    def bark(self):
        return f"{self.name} says Woof!"
    
    # String representation
    def __str__(self):
        return f"{self.name} is {self.age} years old"
    
    def __repr__(self):
        return f"Dog('{self.name}', {self.age})"

# Creating objects
dog1 = Dog("Buddy", 3)
dog2 = Dog("Max", 5)

print(dog1.name)  # Buddy
print(dog1.bark())  # Buddy says Woof!
print(dog1)  # Buddy is 3 years old
```

### Inheritance
```python
# Base class
class Animal:
    def __init__(self, name, age):
        self.name = name
        self.age = age
    
    def speak(self):
        return "Some sound"
    
    def __str__(self):
        return f"{self.name} is {self.age} years old"

# Derived class
class Dog(Animal):
    def __init__(self, name, age, breed):
        super().__init__(name, age)  # Call parent constructor
        self.breed = breed
    
    # Override parent method
    def speak(self):
        return "Woof!"
    
    # Add new method
    def fetch(self):
        return f"{self.name} fetches the ball"

class Cat(Animal):
    def speak(self):
        return "Meow!"

# Usage
dog = Dog("Buddy", 3, "Golden Retriever")
cat = Cat("Whiskers", 2)

print(dog.speak())  # Woof!
print(cat.speak())  # Meow!
print(dog.fetch())  # Buddy fetches the ball
```

### Multiple Inheritance
```python
class Flyable:
    def fly(self):
        return "Flying"

class Swimmable:
    def swim(self):
        return "Swimming"

class Duck(Animal, Flyable, Swimmable):
    def __init__(self, name, age):
        super().__init__(name, age)
    
    def speak(self):
        return "Quack!"

duck = Duck("Donald", 1)
print(duck.fly())   # Flying
print(duck.swim())  # Swimming
```

### Special Methods (Magic Methods)
```python
class Point:
    def __init__(self, x, y):
        self.x = x
        self.y = y
    
    # String representation
    def __str__(self):
        return f"Point({self.x}, {self.y})"
    
    def __repr__(self):
        return f"Point({self.x}, {self.y})"
    
    # Equality
    def __eq__(self, other):
        return self.x == other.x and self.y == other.y
    
    # Less than
    def __lt__(self, other):
        return (self.x**2 + self.y**2) < (other.x**2 + other.y**2)
    
    # Addition
    def __add__(self, other):
        return Point(self.x + other.x, self.y + other.y)
    
    # Length (distance from origin)
    def __len__(self):
        return int((self.x**2 + self.y**2)**0.5)
    
    # Get item (for indexing)
    def __getitem__(self, index):
        if index == 0:
            return self.x
        elif index == 1:
            return self.y
        else:
            raise IndexError("Index out of range")

p1 = Point(3, 4)
p2 = Point(1, 2)
print(p1 + p2)  # Point(4, 6)
print(p1 == p2)  # False
print(len(p1))  # 5
print(p1[0])  # 3
```

### Property Decorators
```python
class Circle:
    def __init__(self, radius):
        self._radius = radius  # Private convention (leading underscore)
    
    @property
    def radius(self):
        return self._radius
    
    @radius.setter
    def radius(self, value):
        if value < 0:
            raise ValueError("Radius cannot be negative")
        self._radius = value
    
    @property
    def area(self):
        return 3.14159 * self._radius ** 2
    
    @property
    def diameter(self):
        return 2 * self._radius

circle = Circle(5)
print(circle.radius)  # 5
print(circle.area)    # 78.53975
circle.radius = 10
print(circle.area)    # 314.159
```

### Class Methods and Static Methods
```python
class MyClass:
    class_variable = 0
    
    def __init__(self, value):
        self.instance_variable = value
    
    # Instance method (takes self)
    def instance_method(self):
        return f"Instance method: {self.instance_variable}"
    
    # Class method (takes cls)
    @classmethod
    def class_method(cls):
        return f"Class method: {cls.class_variable}"
    
    # Static method (no self or cls)
    @staticmethod
    def static_method():
        return "Static method: no access to instance or class"

obj = MyClass(10)
print(obj.instance_method())  # Instance method: 10
print(MyClass.class_method())  # Class method: 0
print(MyClass.static_method())  # Static method: no access to instance or class
```

### Abstract Base Classes
```python
from abc import ABC, abstractmethod

class Shape(ABC):
    @abstractmethod
    def area(self):
        pass
    
    @abstractmethod
    def perimeter(self):
        pass

class Rectangle(Shape):
    def __init__(self, width, height):
        self.width = width
        self.height = height
    
    def area(self):
        return self.width * self.height
    
    def perimeter(self):
        return 2 * (self.width + self.height)

# Cannot instantiate Shape directly
# shape = Shape()  # Error!

rect = Rectangle(5, 3)
print(rect.area())  # 15
```

---

## File Handling

### Reading Files
```python
# Read entire file
with open("file.txt", "r") as f:
    content = f.read()

# Read line by line
with open("file.txt", "r") as f:
    for line in f:
        print(line.strip())

# Read all lines as list
with open("file.txt", "r") as f:
    lines = f.readlines()

# Read specific number of characters
with open("file.txt", "r") as f:
    chunk = f.read(100)  # Read first 100 characters
```

### Writing Files
```python
# Write to file (overwrites existing)
with open("file.txt", "w") as f:
    f.write("Hello, World!\n")
    f.write("Second line\n")

# Append to file
with open("file.txt", "a") as f:
    f.write("Appended line\n")

# Write multiple lines
lines = ["Line 1\n", "Line 2\n", "Line 3\n"]
with open("file.txt", "w") as f:
    f.writelines(lines)
```

### File Modes
```python
# "r" - Read (default)
# "w" - Write (overwrites)
# "a" - Append
# "x" - Exclusive creation (fails if exists)
# "b" - Binary mode
# "t" - Text mode (default)
# "+" - Read and write

# Examples
open("file.txt", "r")    # Read text
open("file.txt", "w")    # Write text
open("file.txt", "a")    # Append text
open("file.bin", "rb")   # Read binary
open("file.bin", "wb")   # Write binary
open("file.txt", "r+")   # Read and write
```

### Working with Paths
```python
import os
from pathlib import Path

# Using os.path
file_path = os.path.join("folder", "subfolder", "file.txt")
dirname = os.path.dirname(file_path)
basename = os.path.basename(file_path)
exists = os.path.exists(file_path)

# Using pathlib (Python 3.4+, recommended)
path = Path("folder") / "subfolder" / "file.txt"
path.parent  # Parent directory
path.name    # Filename
path.exists()  # Check if exists
path.is_file()  # Check if file
path.is_dir()   # Check if directory

# Create directory
Path("new_folder").mkdir(parents=True, exist_ok=True)
```

### CSV Files
```python
import csv

# Reading CSV
with open("data.csv", "r") as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)

# Reading CSV as dictionary
with open("data.csv", "r") as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(row["name"], row["age"])

# Writing CSV
with open("output.csv", "w", newline="") as f:
    writer = csv.writer(f)
    writer.writerow(["Name", "Age", "City"])
    writer.writerow(["Alice", "30", "NYC"])
    writer.writerow(["Bob", "25", "LA"])

# Writing CSV as dictionary
with open("output.csv", "w", newline="") as f:
    fieldnames = ["name", "age", "city"]
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerow({"name": "Alice", "age": "30", "city": "NYC"})
```

---

## Exception Handling

### Basic Try-Except
```python
# Basic exception handling
try:
    result = 10 / 0
except ZeroDivisionError:
    print("Cannot divide by zero")

# Multiple exceptions
try:
    value = int(input("Enter a number: "))
    result = 10 / value
except ValueError:
    print("Invalid input")
except ZeroDivisionError:
    print("Cannot divide by zero")
except Exception as e:
    print(f"An error occurred: {e}")
```

### Exception Hierarchy
```python
try:
    # Code that might raise exception
    pass
except ValueError:
    # Handle ValueError
    pass
except (TypeError, KeyError):
    # Handle multiple exceptions
    pass
except Exception:
    # Handle any other exception
    pass
else:
    # Execute if no exception occurred
    pass
finally:
    # Always execute
    pass
```

### Raising Exceptions
```python
# Raise exception
if value < 0:
    raise ValueError("Value cannot be negative")

# Raise with custom message
raise TypeError("Invalid type")

# Re-raise exception
try:
    # Some code
    pass
except Exception as e:
    print("Error occurred")
    raise  # Re-raise the exception
```

### Custom Exceptions
```python
# Custom exception class
class CustomError(Exception):
    pass

class ValidationError(Exception):
    def __init__(self, message, value):
        self.message = message
        self.value = value
        super().__init__(self.message)

# Usage
def validate_age(age):
    if age < 0:
        raise ValidationError("Age cannot be negative", age)
    if age > 150:
        raise ValidationError("Age is too large", age)

try:
    validate_age(-5)
except ValidationError as e:
    print(f"Validation error: {e.message}, value: {e.value}")
```

### Context Managers
```python
# Using with statement (automatic resource management)
with open("file.txt", "r") as f:
    content = f.read()
# File automatically closed

# Custom context manager
class FileManager:
    def __init__(self, filename, mode):
        self.filename = filename
        self.mode = mode
        self.file = None
    
    def __enter__(self):
        self.file = open(self.filename, self.mode)
        return self.file
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        if self.file:
            self.file.close()

# Usage
with FileManager("file.txt", "r") as f:
    content = f.read()
```

---

## Regular Expressions

### Basic Usage
```python
import re

# Search for pattern
text = "The price is $50"
match = re.search(r'\$(\d+)', text)
if match:
    print(match.group(0))  # $50
    print(match.group(1))  # 50

# Find all matches
text = "Contact: alice@example.com or bob@example.com"
emails = re.findall(r'\b[\w.-]+@[\w.-]+\.\w+\b', text)
print(emails)  # ['alice@example.com', 'bob@example.com']

# Replace
text = "Hello, World!"
new_text = re.sub(r'World', 'Python', text)
print(new_text)  # Hello, Python!

# Split
text = "apple,banana,cherry"
fruits = re.split(r',', text)
print(fruits)  # ['apple', 'banana', 'cherry']
```

### Common Patterns
```python
# Email
pattern = r'\b[\w.-]+@[\w.-]+\.\w+\b'

# Phone number (US format)
pattern = r'\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}'

# URL
pattern = r'https?://(?:[-\w.])+(?:[:\d]+)?(?:/(?:[\w/_.])*(?:\?(?:[\w&=%.])*)?(?:#(?:\w)*)?)?'

# Date (MM/DD/YYYY)
pattern = r'\d{2}/\d{2}/\d{4}'

# Word boundaries
pattern = r'\bword\b'  # Matches "word" but not "words"
```

### Regex Flags
```python
# re.IGNORECASE (re.I) - Case insensitive
re.search(r'hello', 'HELLO', re.IGNORECASE)

# re.MULTILINE (re.M) - ^ and $ match line boundaries
re.findall(r'^\d+', '123\n456\n789', re.MULTILINE)

# re.DOTALL (re.S) - . matches newline
re.search(r'a.b', 'a\nb', re.DOTALL)

# re.VERBOSE (re.X) - Ignore whitespace and comments
pattern = re.compile(r"""
    \d{3}      # Area code
    -          # Dash
    \d{3}      # Exchange
    -          # Dash
    \d{4}      # Number
""", re.VERBOSE)
```

---

## Working with Dates and Time

### datetime Module
```python
from datetime import datetime, date, time, timedelta

# Current date and time
now = datetime.now()
print(now)  # 2024-01-15 10:30:45.123456

# Specific date/time
dt = datetime(2024, 1, 15, 10, 30, 45)
d = date(2024, 1, 15)
t = time(10, 30, 45)

# Formatting
formatted = now.strftime("%Y-%m-%d %H:%M:%S")
print(formatted)  # 2024-01-15 10:30:45

# Parsing
dt = datetime.strptime("2024-01-15 10:30:45", "%Y-%m-%d %H:%M:%S")

# Time delta
tomorrow = now + timedelta(days=1)
next_week = now + timedelta(weeks=1)
one_hour_later = now + timedelta(hours=1)

# Date arithmetic
difference = tomorrow - now
print(difference.days)  # 1
print(difference.seconds)  # Seconds component
```

### time Module
```python
import time

# Current time (seconds since epoch)
current_time = time.time()

# Sleep
time.sleep(2)  # Sleep for 2 seconds

# Format time
formatted = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime())

# Parse time
parsed = time.strptime("2024-01-15 10:30:45", "%Y-%m-%d %H:%M:%S")
```

---

## JSON and Data Serialization

### Working with JSON
```python
import json

# Python object to JSON string
data = {
    "name": "Alice",
    "age": 30,
    "cities": ["NYC", "LA", "Chicago"],
    "married": False
}
json_str = json.dumps(data)
print(json_str)

# JSON string to Python object
data = json.loads(json_str)
print(data["name"])  # Alice

# Read from JSON file
with open("data.json", "r") as f:
    data = json.load(f)

# Write to JSON file
with open("data.json", "w") as f:
    json.dump(data, f, indent=4)  # indent for pretty printing
```

### Pickle (Python-specific serialization)
```python
import pickle

# Serialize to bytes
data = {"name": "Alice", "age": 30}
serialized = pickle.dumps(data)

# Deserialize from bytes
data = pickle.loads(serialized)

# Serialize to file
with open("data.pkl", "wb") as f:
    pickle.dump(data, f)

# Deserialize from file
with open("data.pkl", "rb") as f:
    data = pickle.load(f)
```

---

## Iterators and Generators

### Iterators
```python
# Creating iterator
class Counter:
    def __init__(self, low, high):
        self.current = low
        self.high = high
    
    def __iter__(self):
        return self
    
    def __next__(self):
        if self.current > self.high:
            raise StopIteration
        else:
            self.current += 1
            return self.current - 1

# Usage
counter = Counter(1, 5)
for num in counter:
    print(num)  # 1, 2, 3, 4, 5
```

### Generators
```python
# Generator function
def countdown(n):
    while n > 0:
        yield n
        n -= 1

# Usage
for num in countdown(5):
    print(num)  # 5, 4, 3, 2, 1

# Generator expression
squares = (x**2 for x in range(10))
for square in squares:
    print(square)

# Generator vs list comprehension
# List comprehension (eager evaluation)
squares_list = [x**2 for x in range(10)]  # Creates list immediately

# Generator expression (lazy evaluation)
squares_gen = (x**2 for x in range(10))  # Creates generator
```

### Generator Use Cases
```python
# Memory-efficient processing
def read_large_file(filename):
    with open(filename, "r") as f:
        for line in f:
            yield line.strip()

# Infinite sequences
def fibonacci():
    a, b = 0, 1
    while True:
        yield a
        a, b = b, a + b

# Pipeline processing
def numbers():
    for i in range(10):
        yield i

def square(nums):
    for num in nums:
        yield num ** 2

def even(nums):
    for num in nums:
        if num % 2 == 0:
            yield num

# Chain generators
result = even(square(numbers()))
for num in result:
    print(num)  # 0, 4, 16, 36, 64
```

---

## Practice Exercises

1. Create a class `BankAccount` with methods to deposit, withdraw, and check balance
2. Write a function that reads a CSV file and returns a list of dictionaries
3. Implement a custom exception class for validation errors
4. Create a generator function that yields Fibonacci numbers
5. Write a context manager for timing code execution
6. Create a decorator that logs function calls
7. Implement a class with properties that validate input
8. Write a function that uses regular expressions to extract email addresses from text
9. Create a module with utility functions for date manipulation
10. Implement a class hierarchy for different types of animals with polymorphism

