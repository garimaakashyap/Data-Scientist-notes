# Tableau Intermediate - Complete Guide

## 1. Advanced Calculations

### Level of Detail (LOD) Expressions

**What are LOD Expressions?**
LOD expressions allow you to compute values at different levels of granularity than the visualization.

### Types of LOD Expressions

**1. FIXED**
```
{FIXED [Category] : SUM([Sales])}
```
- Computes at specified dimension level
- Ignores view filters (unless context filter)
- Example: Total sales per category regardless of other filters

**2. INCLUDE**
```
{INCLUDE [Region] : SUM([Sales])}
```
- Adds dimension to calculation
- Respects all filters
- Example: Sales including region detail

**3. EXCLUDE**
```
{EXCLUDE [Category] : SUM([Sales])}
```
- Removes dimension from calculation
- Respects other filters
- Example: Sales excluding category

### LOD Examples

**Average Sales per Customer:**
```
{FIXED [Customer ID] : AVG([Sales])}
```

**Sales per Region (ignoring other filters):**
```
{FIXED [Region] : SUM([Sales])}
```

**Running Total:**
```
{INCLUDE [Date] : SUM([Sales])}
```

### Table Calculations

**What are Table Calculations?**
Calculations computed from the table structure, not the data source.

### Common Table Calculations

**1. Running Total:**
- Right-click measure → Quick Table Calculation → Running Total
- Or use formula:
```
RUNNING_SUM(SUM([Sales]))
```

**2. Percent of Total:**
```
SUM([Sales]) / TOTAL(SUM([Sales]))
```

**3. Rank:**
```
RANK(SUM([Sales]))
```

**4. Percent Difference:**
- Right-click measure → Quick Table Calculation → Percent Difference
- Compares to previous period

**5. Moving Average:**
```
WINDOW_AVG(SUM([Sales]), -6, 0)
```
- 7-day moving average

### Table Calculation Functions

**WINDOW Functions:**
```
WINDOW_SUM(expression, [start, end])
WINDOW_AVG(expression, [start, end])
WINDOW_MAX(expression, [start, end])
WINDOW_MIN(expression, [start, end])
```

**RANK Functions:**
```
RANK(expression, ['asc'|'desc'])
RANK_DENSE(expression)
RANK_MODIFIED(expression)
RANK_PERCENTILE(expression)
```

**SIZE Functions:**
```
SIZE()  // Number of rows in partition
INDEX()  // Current row index
FIRST()  // First row in partition
LAST()  // Last row in partition
```

### Addressing and Partitioning

**Partitioning:**
- Defines scope of calculation
- What to compute over
- Set in Table Calculation dialog

**Addressing:**
- Defines direction of calculation
- How to compute
- Set in Table Calculation dialog

## 2. Advanced Data Connections

### Joins

**What are Joins?**
Combine data from multiple tables based on common fields.

### Join Types

**1. Inner Join:**
- Only matching records
- Most common
- Default in Tableau

**2. Left Join:**
- All records from left table
- Matching from right table
- NULLs for non-matches

**3. Right Join:**
- All records from right table
- Matching from left table
- NULLs for non-matches

**4. Full Outer Join:**
- All records from both tables
- NULLs for non-matches

### Creating Joins

**Steps:**
1. Connect to first data source
2. Drag second data source
3. Drag to "Add" area
4. Select join type
5. Set join conditions
6. Click OK

### Unions

**What are Unions?**
Combine rows from multiple tables with same structure.

**Creating Unions:**
1. Connect to data source
2. Drag another instance
3. Select "Union"
4. Tableau auto-unions or manual union

### Data Blending

**What is Data Blending?**
Combine data from different data sources without joining.

**How to Blend:**
1. Connect to primary data source
2. Connect to secondary data source
3. Use fields from both sources
4. Tableau blends automatically

**Blending vs Joins:**
- **Blending:** Different data sources, aggregated level
- **Joins:** Same data source, row level

## 3. Parameters

### What are Parameters?
Dynamic values that users can change to affect calculations and filters.

### Creating Parameters

**Steps:**
1. Right-click Data pane → Create Parameter
2. Configure:
   - Name
   - Data type
   - Current value
   - Allowable values
   - Display format
3. Click OK

### Using Parameters

**In Calculations:**
```
Sales Threshold = [Sales] > [Parameter]
```

**In Filters:**
1. Create parameter
2. Right-click parameter → Show Parameter Control
3. Use in filter condition

**Dynamic Calculations:**
```
Top N Sales = 
IF RANK(SUM([Sales])) <= [Top N Parameter]
THEN SUM([Sales])
END
```

### Parameter Examples

**Top N:**
```
Top N Products = 
IF RANK(SUM([Sales])) <= [N Value]
THEN [Product]
END
```

**Date Range:**
```
Date Filter = 
[Order Date] >= [Start Date] AND
[Order Date] <= [End Date]
```

**Measure Selection:**
```
Selected Measure = 
CASE [Measure Parameter]
    WHEN "Sales" THEN SUM([Sales])
    WHEN "Profit" THEN SUM([Profit])
    WHEN "Quantity" THEN SUM([Quantity])
END
```

## 4. Advanced Visualizations

### Dual Axis

**What is Dual Axis?**
Two measures on same chart with different scales.

**Creating Dual Axis:**
1. Drag first measure to Rows
2. Drag second measure to Rows
3. Right-click second measure → Dual Axis
4. Synchronize axes if needed

**Example:**
- Sales (left axis)
- Profit (right axis)
- Same time period

### Combined Charts

**Bar + Line:**
1. Create bar chart
2. Add second measure
3. Change mark type to line
4. Use dual axis

**Area + Line:**
1. Create area chart
2. Add line measure
3. Use dual axis

### Reference Lines

**What are Reference Lines?**
Lines or bands added to show targets, averages, or thresholds.

**Adding Reference Lines:**
1. Right-click axis → Add Reference Line
2. Choose type:
   - Constant
   - Per Cell
   - Per Pane
3. Configure:
   - Value
   - Label
   - Formatting

**Reference Line Types:**
- **Line:** Single line
- **Band:** Shaded area
- **Distribution:** Statistical distribution

### Trend Lines

**What are Trend Lines?**
Statistical lines showing data trends.

**Adding Trend Lines:**
1. Right-click visualization → Trend Lines → Show Trend Lines
2. Choose model:
   - Linear
   - Logarithmic
   - Polynomial
   - Exponential
   - Power

**Trend Line Options:**
- Show confidence intervals
- Show equation
- Show R-squared value

### Forecasting

**What is Forecasting?**
Predict future values based on historical data.

**Enabling Forecasting:**
1. Right-click visualization → Forecast → Show Forecast
2. Configure:
   - Forecast length
   - Confidence intervals
   - Seasonality

**Forecast Options:**
- Forecast length
- Ignore last periods
- Seasonality
- Confidence intervals

## 5. Advanced Sets

### Dynamic Sets

**Creating Dynamic Sets:**
1. Right-click field → Create → Set
2. Choose "Use all" or "Use top"
3. Set condition:
   - By field
   - By formula
4. Configure condition

**Example:**
```
Top 10 Products by Sales
- Use top: 10
- By field: Sales
- Sum
```

### Set Actions

**What are Set Actions?**
Interactive sets that change based on user selection.

**Creating Set Actions:**
1. Create set
2. Dashboard → Actions → Add Action → Change Set Values
3. Configure:
   - Source sheets
   - Target set
   - Selection method

**Use Cases:**
- Highlight selected items
- Filter related data
- Dynamic calculations

### In/Out Sets

**Creating In/Out Sets:**
1. Create set
2. Use in visualization
3. Shows "In" and "Out" of set
4. Users can modify set

## 6. Advanced Formatting

### Custom Number Formats

**Creating Custom Formats:**
1. Right-click field → Format
2. Numbers → Custom
3. Enter format string:
   - `#,##0` - Thousands separator
   - `$#,##0.00` - Currency
   - `0.0%` - Percentage
   - `#,##0.0,"K"` - Thousands abbreviation

**Format Examples:**
```
#,##0          → 1,234
$#,##0.00      → $1,234.56
0.0%           → 12.5%
#,##0.0,"K"    → 1.2K
```

### Custom Colors

**Creating Custom Palettes:**
1. Format → Colors → Edit Colors
2. Select palette
3. Customize colors
4. Save palette

**Color Coding:**
- Use color meaningfully
- Consistent across sheets
- Consider colorblind users
- Use gradients for measures

### Custom Shapes

**Using Custom Shapes:**
1. Marks card → Shape
2. Click Shape → More Shapes
3. Import custom shapes
4. Assign to dimension values

**Shape Maps:**
- Use shapes for geographic data
- Custom icons
- Brand logos

## 7. Advanced Dashboards

### Dashboard Actions

**What are Dashboard Actions?**
Interactions between dashboard objects.

### Types of Actions

**1. Filter Actions:**
- Filter one sheet from another
- Click to filter
- Hover to filter

**2. Highlight Actions:**
- Highlight related marks
- Show relationships
- Visual connections

**3. URL Actions:**
- Open web pages
- Link to external content
- Pass parameters

**Creating Actions:**
1. Dashboard → Actions → Add Action
2. Choose action type
3. Configure:
   - Source sheets
   - Target sheets
   - Run action on: Select, Hover, Menu

### Dashboard Layout

**Container Objects:**
- Horizontal container
- Vertical container
- Tiled layout
- Responsive design

**Object Hierarchy:**
- Containers
- Worksheets
- Objects
- Nested containers

### Device Layouts

**What are Device Layouts?**
Different layouts for different devices.

**Creating Device Layouts:**
1. Dashboard → Device Layouts
2. Choose device:
   - Desktop
   - Tablet
   - Phone
3. Customize layout
4. Hide/show objects

## 8. Advanced Mapping

### Geographic Data

**Geographic Roles:**
- Assign geographic roles to fields
- Right-click field → Geographic Role
- Choose role (Country, State, City, etc.)

**Custom Geocoding:**
- Import custom locations
- Map → Geocoding → Import Custom Geocoding
- Use for specific locations

### Map Layers

**Adding Map Layers:**
1. Map → Map Layers
2. Add layers:
   - Streets
   - Light/Dark
   - Satellite
   - Custom layers

**Map Options:**
- Background maps
- Map services
- WMS servers
- Custom images

### Spatial Data

**Spatial Files:**
- Shapefiles
- KML files
- GeoJSON
- Tableau extracts with spatial data

**Spatial Functions:**
```
MAKEPOINT([Latitude], [Longitude])
MAKELINE([Point1], [Point2])
BUFFER([Point], [Distance])
```

## 9. Performance Optimization

### Data Extracts

**What are Extracts?**
Local copies of data for faster performance.

**Creating Extracts:**
1. Data → Extract Data
2. Configure:
   - Filters
   - Aggregation
   - Incremental refresh
3. Create extract

**Extract Benefits:**
- Faster performance
- Work offline
- Reduced database load
- Optimized storage

### Incremental Refresh

**Setting Up Incremental Refresh:**
1. Data → Extract Data
2. Incremental Refresh
3. Set refresh field
4. Configure refresh schedule

**Benefits:**
- Faster refreshes
- Only new data
- Efficient updates

### Data Source Filters

**Adding Data Source Filters:**
1. Data source → Add
2. Choose filter
3. Apply to all worksheets
4. Improves performance

### Optimizing Calculations

**Best Practices:**
- Use aggregations when possible
- Avoid unnecessary calculations
- Use LOD expressions efficiently
- Test performance

## 10. Advanced Analytics

### Clustering

**What is Clustering?**
Group similar data points automatically.

**Creating Clusters:**
1. Drag fields to view
2. Analytics pane → Cluster
3. Drag to view
4. Configure clusters

**Cluster Options:**
- Number of clusters
- Variables
- Clustering method

### Reference Distributions

**Adding Distributions:**
1. Analytics pane → Distribution
2. Choose type:
   - Box plot
   - Quartiles
   - Standard deviation
3. Drag to view

### Custom Territories

**Creating Territories:**
1. Select marks on map
2. Map → Create Territory
3. Name territory
4. Use in analysis

**Territory Uses:**
- Sales regions
- Geographic groupings
- Custom boundaries

## Key Takeaways

1. **LOD Expressions:** Calculate at different granularity levels
2. **Table Calculations:** Compute from table structure
3. **Parameters:** Dynamic user inputs
4. **Advanced Visuals:** Dual axis, reference lines, trend lines
5. **Data Connections:** Joins, unions, blending
6. **Advanced Sets:** Dynamic sets, set actions
7. **Dashboard Actions:** Filter, highlight, URL actions
8. **Mapping:** Geographic data, spatial functions
9. **Performance:** Extracts, incremental refresh, optimization
10. **Analytics:** Clustering, distributions, territories

---

*Master these intermediate techniques for professional Tableau dashboards!*

