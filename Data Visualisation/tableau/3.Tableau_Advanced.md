# Tableau Advanced - Complete Guide

## 1. Advanced Calculations

### Advanced LOD Expressions

**Nested LOD:**
```
{FIXED [Category] : 
    {FIXED [Subcategory] : SUM([Sales])}
}
```

**LOD with Aggregations:**
```
{FIXED [Region] : 
    AVG({FIXED [Customer] : SUM([Sales])})
}
```
- Average of customer totals per region

**LOD with Conditions:**
```
{FIXED [Customer] : 
    IF SUM([Sales]) > 1000 
    THEN "High Value" 
    ELSE "Low Value" 
    END
}
```

### Advanced Table Calculations

**Window Functions:**
```
WINDOW_SUM(SUM([Sales]), -2, 2)
// Sum of current row ± 2 rows

WINDOW_AVG(SUM([Sales]), FIRST(), 0)
// Average from first to current

WINDOW_MAX(SUM([Sales]), -6, 0)
// Maximum of last 7 periods
```

**Lookup Functions:**
```
LOOKUP(SUM([Sales]), -1)
// Previous period value

LOOKUP(SUM([Sales]), 1)
// Next period value

LOOKUP(SUM([Sales]), -12)
// Same period last year
```

**First/Last Functions:**
```
FIRST()
LAST()
INDEX()
SIZE()
```

### Advanced String Functions

**Pattern Matching:**
```
CONTAINS([Product], "Pro")
STARTSWITH([Product], "A")
ENDSWITH([Product], "X")
REGEXP_MATCH([Email], ".*@.*\\..*")
```

**String Manipulation:**
```
SPLIT([Full Name], " ", 1)  // First name
SPLIT([Full Name], " ", 2)  // Last name
REPLACE([Text], "Old", "New")
REGEXP_REPLACE([Text], "pattern", "replacement")
```

### Advanced Date Functions

**Date Calculations:**
```
DATEDIFF('day', [Start Date], [End Date])
DATEDIFF('month', [Order Date], TODAY())
DATEADD('month', 3, [Order Date])
DATETRUNC('quarter', [Order Date])
```

**Date Intelligence:**
```
DATEPART('weekday', [Date])
DATENAME('month', [Date])
MAKEDATE(2024, 1, 1)
ISDATE([Text Field])
```

### Advanced Logical Functions

**Complex IF Statements:**
```
IF [Sales] > 1000 AND [Profit] > 100 
THEN "High"
ELSEIF [Sales] > 500 
THEN "Medium"
ELSE "Low"
END
```

**CASE Statements:**
```
CASE [Region]
    WHEN "North" THEN 1
    WHEN "South" THEN 2
    WHEN "East" THEN 3
    WHEN "West" THEN 4
    ELSE 0
END
```

## 2. Advanced Data Modeling

### Data Modeling Best Practices

**Star Schema:**
- Fact table in center
- Dimension tables around
- Clean relationships
- Optimal performance

**Snowflake Schema:**
- Normalized dimensions
- More tables
- Less redundancy
- More complex

### Custom SQL

**When to Use:**
- Complex joins
- Database-specific functions
- Performance optimization
- Pre-aggregation

**Creating Custom SQL:**
1. Connect to data source
2. New Custom SQL
3. Enter SQL query
4. Execute and use

**Example:**
```sql
SELECT 
    o.OrderID,
    o.OrderDate,
    c.CustomerName,
    SUM(od.Quantity * od.Price) as Total
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
GROUP BY o.OrderID, o.OrderDate, c.CustomerName
```

### Data Source Optimization

**Extract Optimization:**
- Filter early
- Aggregate when possible
- Remove unused columns
- Use incremental refresh

**Connection Optimization:**
- Use extracts for large data
- Optimize queries
- Use appropriate connection type
- Cache connections

## 3. Advanced Visualizations

### Advanced Chart Types

**Waterfall Charts:**
1. Create bar chart
2. Add table calculation
3. Use Gantt marks
4. Show cumulative effect

**Funnel Charts:**
1. Create bar chart
2. Sort descending
3. Use custom shapes
4. Show conversion process

**Sankey Diagrams:**
- Use custom SQL
- Create flow visualization
- Show relationships
- Path analysis

**Box Plots:**
1. Analytics pane → Box Plot
2. Drag to view
3. Show distribution
4. Identify outliers

**Bullet Graphs:**
1. Create bar chart
2. Add reference lines
3. Show targets
4. Performance indicators

### Custom Visualizations

**Using R:**
1. Connect to R server
2. Create R calculated field
3. Use R visualizations
4. Advanced analytics

**Using Python:**
1. Connect to Python
2. Create Python calculated field
3. Use Python libraries
4. Machine learning integration

**Example R:**
```r
SCRIPT_REAL("
    library(forecast)
    ts_data <- ts(.arg1, frequency=12)
    forecast_result <- forecast(ts_data, h=12)
    forecast_result$mean
", SUM([Sales]))
```

### Advanced Formatting

**Conditional Formatting:**
```
IF SUM([Sales]) > 1000 
THEN "Green"
ELSEIF SUM([Sales]) > 500 
THEN "Yellow"
ELSE "Red"
END
```

**Dynamic Formatting:**
- Use parameters
- Conditional colors
- Dynamic labels
- Responsive design

## 4. Advanced Dashboard Design

### Dashboard Best Practices

**Layout Principles:**
- Visual hierarchy
- Consistent spacing
- Clear navigation
- Focus on key metrics

**Design Patterns:**
- KPI dashboard
- Operational dashboard
- Analytical dashboard
- Strategic dashboard

### Advanced Actions

**Parameter Actions:**
1. Create parameter
2. Dashboard → Actions → Change Parameter
3. Configure action
4. Dynamic parameter updates

**Set Actions (Advanced):**
- Multiple set interactions
- Complex set logic
- Dynamic set creation
- Set-based calculations

**URL Actions (Advanced):**
- Dynamic URLs
- Parameter passing
- External integration
- API calls

### Dashboard Extensions

**What are Extensions?**
- Custom JavaScript applications
- Extend Tableau functionality
- Third-party integrations
- Custom interactions

**Using Extensions:**
1. Dashboard → Extension
2. Choose extension
3. Configure settings
4. Deploy extension

## 5. Advanced Analytics Integration

### Statistical Functions

**Statistical Calculations:**
```
STDEV([Sales])
VAR([Sales])
CORR([Sales], [Profit])
COVAR([Sales], [Profit])
```

**Regression:**
```
SLOPE([Sales], [Profit])
INTERCEPT([Sales], [Profit])
R_SQUARED([Sales], [Profit])
```

### Predictive Analytics

**Forecasting Models:**
- Exponential smoothing
- ARIMA models
- Seasonal patterns
- Confidence intervals

**Advanced Forecasting:**
1. Enable forecasting
2. Configure model
3. Adjust parameters
4. Validate results

### Machine Learning Integration

**R Integration:**
- Connect to R server
- Use R packages
- Machine learning models
- Predictive analytics

**Python Integration:**
- Connect to Python
- Use scikit-learn
- TensorFlow models
- Advanced ML

**TabPy:**
- Tableau Python Server
- Deploy models
- Real-time predictions
- Advanced analytics

## 6. Advanced Performance Tuning

### Query Optimization

**Optimizing Queries:**
- Use extracts
- Filter early
- Aggregate at source
- Optimize joins

**Query Performance:**
- Monitor query times
- Identify slow queries
- Optimize calculations
- Use appropriate data types

### Extract Optimization

**Best Practices:**
- Incremental refresh
- Filter extracts
- Aggregate extracts
- Optimize storage

**Extract Configuration:**
- Row limit
- Column selection
- Aggregation level
- Refresh schedule

### Calculation Optimization

**Efficient Calculations:**
- Use aggregations
- Avoid row-level calculations
- Cache results
- Optimize LOD expressions

**Performance Testing:**
- Use Performance Recorder
- Identify bottlenecks
- Optimize slow calculations
- Test improvements

## 7. Advanced Security

### Row-Level Security

**What is RLS?**
Restrict data access based on user attributes.

**Implementing RLS:**
1. Create user filter
2. Use USERNAME() function
3. Filter data dynamically
4. Test security

**Example:**
```
[Salesperson] = USERNAME()
```

### User Filters

**Dynamic User Filters:**
```
[Region] = LOOKUP(
    USERNAME(),
    [User Table],
    [Region]
)
```

**Hierarchical Security:**
- Manager sees team data
- User sees own data
- Department-based access

### Data Security

**Data Source Security:**
- Connection security
- Credential management
- Encrypted connections
- Secure extracts

## 8. Advanced Deployment

### Server Administration

**Server Management:**
- User management
- Project organization
- Permissions
- Scheduling

**Content Management:**
- Publishing workbooks
- Data source management
- Extract refresh
- Monitoring

### Automation

**TabCmd:**
- Command-line tool
- Automate tasks
- Batch operations
- Scripting

**TabPy:**
- Python integration
- Automated analysis
- Model deployment
- API integration

**REST API:**
- Programmatic access
- Automation
- Integration
- Custom solutions

### Best Practices

**Version Control:**
- Use TWBX files
- Document changes
- Track versions
- Backup regularly

**Deployment Process:**
- Development → Testing → Production
- Staged deployment
- Testing procedures
- Rollback plans

## 9. Advanced Integration

### Web Data Connectors

**What are WDCs?**
Custom connectors to web data sources.

**Creating WDCs:**
1. Use WDC SDK
2. Write JavaScript
3. Connect to API
4. Deploy connector

### API Integration

**Tableau REST API:**
- Programmatic access
- Workbook management
- User management
- Data source management

**Example:**
```python
import tableauserverclient as TSC

server = TSC.Server('https://server.tableau.com')
server.auth.sign_in(username='user', password='pass')

# Get workbooks
workbooks = server.workbooks.get()
```

### Embedded Analytics

**Embedding Tableau:**
- JavaScript API
- Embed in web pages
- Customize appearance
- Interactive dashboards

**Authentication:**
- Trusted tickets
- OAuth
- SAML
- Custom authentication

## 10. Advanced Techniques

### Advanced Parameters

**Parameter Actions:**
- Change parameters from dashboard
- Dynamic calculations
- Interactive controls
- User-driven analysis

**Parameter Cascading:**
- Dependent parameters
- Dynamic lists
- Conditional values
- Complex interactions

### Advanced Sets

**Set Combinations:**
- Set intersections
- Set unions
- Set differences
- Complex set logic

**Set Calculations:**
```
IF [Customer] IN [High Value Set]
THEN SUM([Sales])
END
```

### Advanced Mapping

**Custom Geocoding:**
- Import custom locations
- Map specific points
- Custom boundaries
- Spatial analysis

**Spatial Analysis:**
- Distance calculations
- Buffer zones
- Spatial joins
- Geographic calculations

## 11. Troubleshooting and Optimization

### Common Issues

**Performance Issues:**
- Slow queries
- Large extracts
- Complex calculations
- Too many marks

**Solutions:**
- Optimize data model
- Use extracts
- Simplify calculations
- Filter data

### Debugging

**Performance Recorder:**
- Record performance
- Identify bottlenecks
- Optimize queries
- Test improvements

**Calculation Debugging:**
- Test calculations
- Use sample data
- Validate results
- Check data types

### Best Practices Summary

**Development:**
- Plan data model
- Optimize early
- Test performance
- Document work

**Deployment:**
- Version control
- Staged deployment
- User training
- Monitoring

**Maintenance:**
- Regular updates
- Performance monitoring
- User feedback
- Continuous improvement

## Key Takeaways

1. **Advanced Calculations:** Complex LOD, table calculations, functions
2. **Data Modeling:** Star schema, custom SQL, optimization
3. **Advanced Visuals:** Custom charts, R/Python integration
4. **Dashboard Design:** Best practices, advanced actions
5. **Analytics:** Statistical functions, ML integration
6. **Performance:** Query optimization, extract optimization
7. **Security:** Row-level security, user filters
8. **Deployment:** Server administration, automation
9. **Integration:** APIs, web connectors, embedding
10. **Advanced Techniques:** Parameters, sets, mapping

---

*Master these advanced techniques to become a Tableau expert!*

