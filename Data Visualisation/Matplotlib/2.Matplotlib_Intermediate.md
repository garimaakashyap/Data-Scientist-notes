# Matplotlib Intermediate - Complete Guide

## 1. Advanced Plot Customization

### Customizing Axes

```python
import matplotlib.pyplot as plt
import numpy as np

fig, ax = plt.subplots(figsize=(10, 6))
x = np.linspace(0, 10, 100)
y = np.sin(x)

ax.plot(x, y)

# Customize axes
ax.set_xlabel('X-axis', fontsize=14, fontweight='bold')
ax.set_ylabel('Y-axis', fontsize=14, fontweight='bold')
ax.set_title('Customized Axes', fontsize=16, pad=20)

# Set axis limits
ax.set_xlim(0, 10)
ax.set_ylim(-1.5, 1.5)

# Custom ticks
ax.set_xticks([0, 2, 4, 6, 8, 10])
ax.set_yticks([-1, 0, 1])

# Custom tick labels
ax.set_xticklabels(['Start', '2', '4', '6', '8', 'End'], rotation=45)
ax.set_yticklabels(['Low', 'Mid', 'High'])

plt.tight_layout()
plt.show()
```

### Twin Axes (Two Y-axes)

```python
fig, ax1 = plt.subplots(figsize=(10, 6))

x = np.linspace(0, 10, 100)
y1 = np.sin(x)
y2 = np.cos(x) * 100  # Different scale

# First y-axis
ax1.plot(x, y1, 'b-', label='sin(x)')
ax1.set_xlabel('X')
ax1.set_ylabel('sin(x)', color='b')
ax1.tick_params(axis='y', labelcolor='b')

# Second y-axis
ax2 = ax1.twinx()
ax2.plot(x, y2, 'r-', label='100*cos(x)')
ax2.set_ylabel('100*cos(x)', color='r')
ax2.tick_params(axis='y', labelcolor='r')

plt.title('Twin Axes Plot')
plt.tight_layout()
plt.show()
```

### Logarithmic Scales

```python
fig, axes = plt.subplots(1, 2, figsize=(12, 5))

x = np.logspace(0, 3, 100)  # Logarithmic spacing
y = x**2

# Linear scale
axes[0].plot(x, y)
axes[0].set_xlabel('X (linear)')
axes[0].set_ylabel('Y')
axes[0].set_title('Linear Scale')
axes[0].grid(True)

# Logarithmic scale
axes[1].plot(x, y)
axes[1].set_xscale('log')
axes[1].set_yscale('log')
axes[1].set_xlabel('X (log)')
axes[1].set_ylabel('Y (log)')
axes[1].set_title('Logarithmic Scale')
axes[1].grid(True)

plt.tight_layout()
plt.show()
```

## 2. Advanced Subplots

### Complex Subplot Layouts

```python
# Using GridSpec for complex layouts
from matplotlib.gridspec import GridSpec

fig = plt.figure(figsize=(12, 8))
gs = GridSpec(3, 3, figure=fig)

# Large plot on top
ax1 = fig.add_subplot(gs[0, :])
x = np.linspace(0, 10, 100)
ax1.plot(x, np.sin(x))
ax1.set_title('Top Plot (Full Width)')

# Two plots in middle
ax2 = fig.add_subplot(gs[1, :2])
ax2.plot(x, np.cos(x))
ax2.set_title('Middle Left')

ax3 = fig.add_subplot(gs[1, 2])
ax3.bar(['A', 'B'], [10, 20])
ax3.set_title('Middle Right')

# Bottom plots
ax4 = fig.add_subplot(gs[2, 0])
ax4.scatter(np.random.randn(50), np.random.randn(50))
ax4.set_title('Bottom Left')

ax5 = fig.add_subplot(gs[2, 1:])
ax5.hist(np.random.randn(1000), bins=30)
ax5.set_title('Bottom Right (Wide)')

plt.tight_layout()
plt.show()
```

### Subplot Spacing

```python
fig, axes = plt.subplots(2, 2, figsize=(10, 8))

# Adjust spacing
plt.subplots_adjust(
    left=0.1,      # Left margin
    bottom=0.1,    # Bottom margin
    right=0.9,     # Right margin
    top=0.9,       # Top margin
    wspace=0.3,    # Width spacing between subplots
    hspace=0.3     # Height spacing between subplots
)

for i, ax in enumerate(axes.flat):
    ax.plot(np.random.randn(50))
    ax.set_title(f'Plot {i+1}')

plt.show()
```

## 3. Advanced Plot Types

### Stacked Area Plot

```python
x = np.linspace(0, 10, 100)
y1 = np.sin(x)
y2 = np.cos(x)
y3 = np.sin(x) * np.cos(x)

fig, ax = plt.subplots(figsize=(10, 6))
ax.fill_between(x, 0, y1, alpha=0.5, label='sin(x)')
ax.fill_between(x, y1, y1+y2, alpha=0.5, label='cos(x)')
ax.fill_between(x, y1+y2, y1+y2+y3, alpha=0.5, label='sin(x)*cos(x)')

ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_title('Stacked Area Plot')
ax.legend()
plt.show()
```

### Error Bars

```python
x = np.array([1, 2, 3, 4, 5])
y = np.array([10, 15, 13, 17, 20])
yerr = np.array([1, 2, 1.5, 2.5, 2])

fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# Vertical error bars
axes[0].errorbar(x, y, yerr=yerr, fmt='o', capsize=5, capthick=2)
axes[0].set_xlabel('X')
axes[0].set_ylabel('Y')
axes[0].set_title('Vertical Error Bars')
axes[0].grid(True, alpha=0.3)

# Horizontal error bars
xerr = np.array([0.2, 0.3, 0.25, 0.3, 0.2])
axes[1].errorbar(x, y, xerr=xerr, fmt='s', capsize=5)
axes[1].set_xlabel('X')
axes[1].set_ylabel('Y')
axes[1].set_title('Horizontal Error Bars')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

### Box Plot

```python
data = [np.random.normal(0, std, 100) for std in range(1, 5)]

fig, ax = plt.subplots(figsize=(10, 6))
bp = ax.boxplot(data, labels=['Group 1', 'Group 2', 'Group 3', 'Group 4'],
                patch_artist=True)

# Customize box plot
colors = ['lightblue', 'lightgreen', 'lightcoral', 'lightyellow']
for patch, color in zip(bp['boxes'], colors):
    patch.set_facecolor(color)

ax.set_ylabel('Values')
ax.set_title('Box Plot')
ax.grid(True, alpha=0.3)
plt.show()
```

### Violin Plot

```python
data = [np.random.normal(0, std, 100) for std in range(1, 5)]

fig, ax = plt.subplots(figsize=(10, 6))
parts = ax.violinplot(data, positions=[1, 2, 3, 4], showmeans=True)

# Customize
for pc in parts['bodies']:
    pc.set_facecolor('lightblue')
    pc.set_alpha(0.7)

ax.set_xticks([1, 2, 3, 4])
ax.set_xticklabels(['Group 1', 'Group 2', 'Group 3', 'Group 4'])
ax.set_ylabel('Values')
ax.set_title('Violin Plot')
ax.grid(True, alpha=0.3)
plt.show()
```

### Heatmap

```python
# Create correlation matrix
np.random.seed(42)
data = np.random.randn(10, 10)
correlation_matrix = np.corrcoef(data)

fig, ax = plt.subplots(figsize=(10, 8))
im = ax.imshow(correlation_matrix, cmap='coolwarm', aspect='auto')

# Add colorbar
cbar = plt.colorbar(im, ax=ax)
cbar.set_label('Correlation', rotation=270, labelpad=20)

# Add text annotations
for i in range(10):
    for j in range(10):
        text = ax.text(j, i, f'{correlation_matrix[i, j]:.2f}',
                      ha="center", va="center", color="black", fontsize=8)

ax.set_title('Correlation Heatmap')
plt.tight_layout()
plt.show()
```

## 4. Working with Dates

### Time Series Plotting

```python
import matplotlib.dates as mdates
from datetime import datetime, timedelta

# Create date range
dates = [datetime(2024, 1, 1) + timedelta(days=i) for i in range(30)]
values = np.random.randn(30).cumsum()

fig, ax = plt.subplots(figsize=(12, 6))
ax.plot(dates, values)

# Format x-axis dates
ax.xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m-%d'))
ax.xaxis.set_major_locator(mdates.DayLocator(interval=5))
plt.xticks(rotation=45)

ax.set_xlabel('Date')
ax.set_ylabel('Value')
ax.set_title('Time Series Plot')
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()
```

## 5. 3D Plotting

### 3D Line Plot

```python
from mpl_toolkits.mplot3d import Axes3D

fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection='3d')

t = np.linspace(0, 20, 100)
x = np.sin(t)
y = np.cos(t)
z = t

ax.plot(x, y, z)
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_zlabel('Z')
ax.set_title('3D Line Plot')
plt.show()
```

### 3D Scatter Plot

```python
fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection='3d')

x = np.random.randn(100)
y = np.random.randn(100)
z = np.random.randn(100)
colors = np.random.rand(100)

ax.scatter(x, y, z, c=colors, cmap='viridis', s=50)
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_zlabel('Z')
ax.set_title('3D Scatter Plot')
plt.show()
```

### 3D Surface Plot

```python
fig = plt.figure(figsize=(12, 8))
ax = fig.add_subplot(111, projection='3d')

x = np.linspace(-5, 5, 50)
y = np.linspace(-5, 5, 50)
X, Y = np.meshgrid(x, y)
Z = np.sin(np.sqrt(X**2 + Y**2))

surf = ax.plot_surface(X, Y, Z, cmap='viridis', alpha=0.8)
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_zlabel('Z')
ax.set_title('3D Surface Plot')
fig.colorbar(surf)
plt.show()
```

## 6. Advanced Annotations

### Multiple Annotations

```python
fig, ax = plt.subplots(figsize=(10, 6))
x = np.linspace(0, 10, 100)
y = np.sin(x)

ax.plot(x, y)

# Multiple annotations
annotations = [
    (np.pi/2, 1, 'Maximum', 'above'),
    (3*np.pi/2, -1, 'Minimum', 'below'),
    (np.pi, 0, 'Zero Crossing', 'right')
]

for x_val, y_val, text, position in annotations:
    ax.annotate(text, 
                xy=(x_val, y_val),
                xytext=(10, 10) if position == 'above' else (10, -30),
                textcoords='offset points',
                bbox=dict(boxstyle='round,pad=0.5', facecolor='yellow', alpha=0.5),
                arrowprops=dict(arrowstyle='->', connectionstyle='arc3,rad=0'))

ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_title('Multiple Annotations')
ax.grid(True, alpha=0.3)
plt.show()
```

### Text with Background

```python
fig, ax = plt.subplots(figsize=(10, 6))
x = np.linspace(0, 10, 100)
y = np.sin(x)

ax.plot(x, y)

# Text with background box
ax.text(5, 0.5, 'Important Point', 
        bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5),
        fontsize=12, ha='center')

# Text with arrow
ax.annotate('Peak', xy=(np.pi/2, 1), xytext=(4, 0.5),
           arrowprops=dict(facecolor='black', shrink=0.05, width=2),
           fontsize=12, ha='center')

plt.show()
```

## 7. Custom Styling

### Custom Color Maps

```python
from matplotlib.colors import LinearSegmentedColormap

# Create custom colormap
colors = ['red', 'yellow', 'green']
n_bins = 100
cmap = LinearSegmentedColormap.from_list('custom', colors, N=n_bins)

# Use custom colormap
data = np.random.rand(10, 10)
fig, ax = plt.subplots(figsize=(8, 6))
im = ax.imshow(data, cmap=cmap)
plt.colorbar(im)
plt.show()
```

### Custom Line Styles

```python
from matplotlib.lines import Line2D

fig, ax = plt.subplots(figsize=(10, 6))
x = np.linspace(0, 10, 100)

# Custom dash patterns
ax.plot(x, np.sin(x), linestyle=(0, (3, 1, 1, 1)), label='Custom 1')
ax.plot(x, np.cos(x), linestyle=(0, (5, 5)), label='Custom 2')
ax.plot(x, np.sin(x)*np.cos(x), linestyle=(0, (1, 1)), label='Custom 3')

ax.legend()
ax.grid(True, alpha=0.3)
plt.show()
```

## 8. Interactive Features

### Adding Interactivity

```python
from matplotlib.widgets import Slider

fig, ax = plt.subplots(figsize=(10, 6))
plt.subplots_adjust(bottom=0.25)

x = np.linspace(0, 10, 100)
initial_freq = 1.0
y = np.sin(initial_freq * x)

line, = ax.plot(x, y)
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_title('Interactive Plot')

# Add slider
axfreq = plt.axes([0.25, 0.1, 0.65, 0.03])
freq_slider = Slider(axfreq, 'Freq', 0.1, 5.0, valinit=initial_freq)

def update(val):
    freq = freq_slider.val
    line.set_ydata(np.sin(freq * x))
    fig.canvas.draw_idle()

freq_slider.on_changed(update)
plt.show()
```

## 9. Working with Images

### Display Images

```python
# Create sample image
image = np.random.rand(100, 100)

fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# Grayscale
axes[0].imshow(image, cmap='gray')
axes[0].set_title('Grayscale Image')
axes[0].axis('off')

# Colored
axes[1].imshow(image, cmap='viridis')
axes[1].set_title('Colored Image')
axes[1].axis('off')

plt.tight_layout()
plt.show()
```

### Loading and Displaying Images

```python
from matplotlib import image as mpimg

# Load image (if you have one)
# img = mpimg.imread('image.png')

# Or create sample
img = np.random.rand(100, 100, 3)  # RGB image

fig, ax = plt.subplots(figsize=(8, 8))
ax.imshow(img)
ax.axis('off')
ax.set_title('RGB Image')
plt.show()
```

## 10. Advanced Layouts

### Inset Plots

```python
fig, ax = plt.subplots(figsize=(10, 6))
x = np.linspace(0, 10, 100)
y = np.sin(x)

ax.plot(x, y)
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_title('Main Plot with Inset')

# Create inset
from mpl_toolkits.axes_grid1.inset_locator import inset_axes
axins = inset_axes(ax, width="30%", height="30%", loc='upper right')

# Zoomed view
x_zoom = x[40:60]
y_zoom = y[40:60]
axins.plot(x_zoom, y_zoom, 'r')
axins.set_xlim(x_zoom[0], x_zoom[-1])
axins.set_ylim(y_zoom.min(), y_zoom.max())
axins.set_title('Zoomed View')

plt.show()
```

## 11. Performance Optimization

### Fast Plotting for Large Datasets

```python
# For large datasets, use decimation
x = np.linspace(0, 100, 100000)
y = np.sin(x) + np.random.randn(100000) * 0.1

fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# Slow: plot all points
axes[0].plot(x, y, alpha=0.5)
axes[0].set_title('All Points (Slow)')

# Fast: decimate
step = 100  # Plot every 100th point
axes[1].plot(x[::step], y[::step], alpha=0.5)
axes[1].set_title('Decimated (Fast)')

plt.tight_layout()
plt.show()
```

## Key Takeaways

1. **Twin axes:** Use `twinx()` for two y-axes
2. **Log scales:** `set_xscale('log')`, `set_yscale('log')`
3. **GridSpec:** For complex subplot layouts
4. **3D plots:** Import `mplot3d` for 3D visualization
5. **Time series:** Use `matplotlib.dates` for date formatting
6. **Heatmaps:** Use `imshow()` with colormaps
7. **Annotations:** `annotate()` for arrows and text
8. **Custom colormaps:** Create with `LinearSegmentedColormap`
9. **Performance:** Decimate large datasets for faster plotting
10. **Insets:** Use `inset_axes` for zoomed views

---

*Master these intermediate techniques for professional visualizations!*

